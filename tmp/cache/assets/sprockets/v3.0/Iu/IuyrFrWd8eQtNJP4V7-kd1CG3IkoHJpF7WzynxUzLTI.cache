I"ð(function() {
  $(document).on('turbolinks:load', function() {
    var opt;
    $('.content-title').on('click', function() {
      $(this).addClass('active');
      $('.preview-title').removeClass('active');
      $('#content').show();
      $('#preview').hide();
      return false;
    });
    $('.preview-title').on('click', function() {
      $(this).addClass('active');
      $('.content-title').removeClass('active');
      $('#content').hide();
      $('#preview').show();
      $.ajax({
        url: "/admin/articles/preview",
        type: 'POST',
        data: {
          content: $('#content-input').val()
        },
        success: function(data) {
          return $('#preview').html(data);
        }
      }, false);
      return false;
    });
    $('a#upload_photo').click(function() {
      return $('input[type=file]').show().focus().click().hide();
    });
    opt = {
      type: 'POST',
      url: "/photos",
      success: function(data, status, xhr) {
        var before_text, caret_pos, source, src_merged, txtBox;
        txtBox = $("#content-input");
        caret_pos = txtBox.caret('pos');
        src_merged = "\n" + "![](" + data + ")\n";
        source = txtBox.val();
        before_text = source.slice(0, caret_pos);
        txtBox.val(before_text + src_merged + source.slice(caret_pos + 1, source.count));
        txtBox.caret('pos', caret_pos + src_merged.length);
        return txtBox.focus();
      }
    };
    return $('input[type=file]').fileUpload(opt);
  });

}).call(this);
:ET